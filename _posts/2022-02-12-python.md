---
layout: post
title:  "python 로컬 설치 등.."
date:   2022-02-12 22:50
categories: archives
tags: python
---


## mac (m1)
### python (3.x) 설치
```shell
$ brew install python
$ python3 -V
$ which python3
$ /opt/homebrew/bin/python3
```

### 파이썬3 바라보도록 변경 (only python 3.x)
```shell
$ vi ~/.zshrc
# 맨아래에 추가
$ # Only Python3
$ alias python="/opt/homebrew/bin/python3"
$ alias pip="/opt/homebrew/bin/pip3"
$ wq!
$ source ~/.zshrc
$ which python
$ /opt/homebrew/bin/python3
```

### pyenv, virtualenv로 여러 파이썬 버전 변경하기
```shell
$ brew install pyenv pyenv-virtualenv

$ vi ~/.zshrc
# 맨아래에 추가
# stting pyenv
$ export PYENV_ROOT="$HOME/.pyenv"
$ export PATH="$PYENV_ROOT/bin:$PATH"
$ eval "$(pyenv init --path)"
$ eval "$(pyenv init -)"
$ eval "$(pyenv virtualenv-init -)"
$ wq!
$ source ~/.zshrc


# 설치 가능한 Python 버전
$ pyenv install --list
# 특정한 버전 Python 설치
$ pyenv install 3.9.10
# 특정한 버전 Python 삭제
$ pyenv uninstall 3.9.10
# 설치된 Python list
$ pyenv versions
# 해당 Python 버전을 기본으로 설정
$ pyenv global 3.9.10


#가상환경 만들기 - pyenv virtualenv [version] [name]
$ pyenv virtualenv 3.9.10 py39
# 가상환경 시작하기
$ pyenv activate py39
# 가상환경 종료하기
$ pyenv deactivate
# 가상환경 목룍보기
$ pyenv virtualenvs
```


## error
### pycharm 한글 인코딩 문제
```text
1. Preferences -> Editor -> File Encodings -> UTF-8 로 변경
2. 그래도 안되면 파일의 첫번째 줄에 # -*- coding: utf-8 -*- 추가
```

## 기타
### pycharm 파이썬 2.x -> 3.x로 버전 변경
```text
Preferences -> Python Interpreter -> 설치한 python 버전 추가
```

### json.dumps() 이용시 한글이 유니코드로 저장되는 현상 해결
```text
.dumps() 메서드를 쓸 때 ensure_ascii = False 사용하여 해결
import json
dict = {'key': '내용'}
with open('j.json', 'w', encoding='UTF-8-sig') as f:
     f.write(json.dumps(dict, ensure_ascii=False))
```

### python redis 연동 후 결고값 파일 작성 샘플 작성
```text
# -*- coding: utf-8 -*-
import json
import redis
import time

print('start ' + time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time())))
try:
    encodings = 'UTF-8'
    result = None

    # redis 연결
    with redis.StrictRedis(host='localhost', port=6379, db=0) as rd:
        # redis crud
        dataDict = {
            "key1": "테스트값1",
            "key2": "테스트값2",
            "key3": "테스트값3"
        }

        # redis에 ascii 문자열이 아닌 utf-8 타입의 문자열 저장 후 조회하면 decoding이 되지 않는 문제 발생
        # json dumps(), loads()를 사용해서 데이터 저장 및 읽기
        jsonDataDict = json.dumps(dataDict, ensure_ascii=False).encode(encodings)

        # 데이터 set
        rd.set('dict', jsonDataDict)

        # 데이터 get
        resultData = rd.get("dict")
        resultData = resultData.decode(encodings)

        result = dict(json.loads(resultData))

    # file 열기 모드
    # r(read), w(write), a(append)
    # with 블록을 벗어나는 순간 열린 파일 객체 f 가 자동으로 close
    with open("newFile.txt", 'w', encoding=encodings) as f:
        f.write('')
        f.write(json.dumps(result, ensure_ascii=False))

    f = open("newFile.txt", 'r', encoding=encodings)
    data = f.read()
    print(data)
    f.close()

finally:
    print('final')

print('end ' + time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time())))
```



## 참고
1. [M1 python3 설치](https://imksh.com/90)
2. [mac python(pyenv) 설치 및 버전관리](https://leesh90.github.io/environment/2021/04/03/python-install/)
3. [여러 버전의 파이썬 관리하기 (pyenv)](https://www.daleseo.com/python-pyenv/)
